CREATE DATABASE QEvent
GO
USE QEvent
GO
CREATE TABLE invitadoEspecial(
	ID_invitado INT IDENTITY NOT NULL,
	Nombre VARCHAR(50) NOT NULL,
	Descripcion VARCHAR(300) NOT NULL,	
	PRIMARY KEY (ID_invitado)
)
GO
CREATE TABLE usuario(
	ID_usuario INT IDENTITY NOT NULL,
	Nombre VARCHAR(75) NOT NULL,
	NombreUsuario VARCHAR(20) NOT NULL,
	Contrasena VARCHAR (20) NOT NULL,
	Correo VARCHAR(50) NOT NULL,
	Rol VARCHAR(15) NOT NULL,
	Numero VARCHAR(8) NOT NULL,
	PRIMARY KEY (ID_usuario),
	CHECK (Numero LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'),
	CHECK (Correo LIKE '%___@___%.__%')
)
GO
CREATE TABLE restriccion(
	ID_restriccion INT IDENTITY NOT NULL,
	Detalle VARCHAR(200) NOT NULL,
	PRIMARY KEY (ID_restriccion)
)
GO
CREATE TABLE imagen(
	ID_imagen INT IDENTITY NOT NULL,
	Fuente VARCHAR(300) NOT NULL,
	PRIMARY KEY (ID_imagen)
)
GO
CREATE TABLE codigoQR(
	ID_codigoQR INT IDENTITY NOT NULL,
	codigoQR VARCHAR(100) NOT NULL,
	PRIMARY KEY (ID_codigoQR)
)
GO
CREATE TABLE evento(
   ID_evento INT IDENTITY NOT NULL,
   Nombre VARCHAR(50) NOT NULL,
   Descripcion VARCHAR(300) NOT NULL,
   Ubicacion VARCHAR(200) NOT NULL,
   Fecha DATE NOT NULL, --Formato de Fecha  YYYY-MM-DD
   Hora TIME NOT NULL,
   Tipo VARCHAR(100) NOT NULL,
   ID_invitadoFK INT NOT NULL,
   ID_encargadoFK INT NOT NULL,
   PRIMARY KEY (ID_evento),
   FOREIGN KEY (ID_invitadoFK) REFERENCES invitadoEspecial(ID_invitado),
   FOREIGN KEY (ID_encargadoFK) REFERENCES usuario(ID_usuario)

)
GO
CREATE TABLE evento_imagen(
	ID_evento_imagen INT IDENTITY NOT NULL,
	ID_eventoFK INT NOT NULL,
	ID_imagenFK INT NOT NULL,
	PRIMARY KEY (ID_evento_imagen),
	FOREIGN KEY (ID_eventoFK) REFERENCES evento(ID_evento),
	FOREIGN KEY (ID_imagenFK) REFERENCES imagen(ID_imagen)
)
GO
CREATE TABLE evento_restriccion(
	ID_evento_restriccion INT IDENTITY NOT NULL,
	ID_eventoFK INT NOT NULL,
	ID_restriccionFK INT NOT NULL,
	PRIMARY KEY (ID_evento_restriccion),
	FOREIGN KEY (ID_eventoFK) REFERENCES evento(ID_evento),
	FOREIGN KEY (ID_restriccionFK) REFERENCES restriccion(ID_restriccion)
)
GO
CREATE TABLE invitado_imagen(
	ID_invitado_imagen INT IDENTITY NOT NULL,
	ID_invitadoFK INT NOT NULL,
	ID_imagenFK INT NOT NULL,
	PRIMARY KEY (ID_invitado_imagen),
	FOREIGN KEY (ID_invitadoFK) REFERENCES invitadoEspecial(ID_invitado),
	FOREIGN KEY (ID_imagenFK) REFERENCES imagen(ID_imagen)
)
GO
CREATE TABLE usuario_codigoQR(
	ID_usuario_codigoQR INT IDENTITY NOT NULL,
	ID_usuarioFK INT NOT NULL,
	ID_codigoQRFK INT NOT NULL,
	Revisado BIT NOT NULL,
	PRIMARY KEY (ID_usuario_codigoQR),
	FOREIGN KEY (ID_usuarioFK) REFERENCES usuario(ID_usuario),
	FOREIGN KEY (ID_codigoQRFK) REFERENCES codigoQR(ID_codigoQR)
)
GO
INSERT INTO usuario(Nombre,Correo,Numero,Rol) VALUES('Ignacio','algo@gmail.com','86835719','Administrador')
GO
INSERT INTO invitadoEspecial(Nombre,Descripcion) VALUES('Carlos','BLABLA')
GO
INSERT INTO evento(Nombre,Descripcion,Ubicacion,Fecha,Hora,Tipo,ID_encargadoFK,ID_invitadoFK) VALUES ('Evento 1','Actividad recreativa para niños','Monterrey, San Carlos','2019-12-22','12:30','Cultural',1,1)
GO
SELECT * FROM evento